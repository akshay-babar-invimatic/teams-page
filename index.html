<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teams Personal App - Token Generator</title>
  <script src="https://res.cdn.office.net/teams-js/2.16.0/js/MicrosoftTeams.min.js"></script>
</head>
<body style="font-family: Arial; text-align:center; padding:40px;">
  <h2>Teams Personal App Token Demo</h2>

  <button id="getTokenBtn">Get Token</button>
  <pre id="tokenOutput" style="margin-top:20px; white-space:pre-wrap;"></pre>

  <script>
    let accessToken = "";

    async function getToken() {
      console.log("Initializing Teams SDK...");
      await microsoftTeams.app.initialize();

      console.log("Getting Teams context...");
      const context = await microsoftTeams.app.getContext();
      console.log("Teams context:", context);

      try {
        console.log("Requesting SSO token...");
        const token = await microsoftTeams.authentication.getAuthToken();
        accessToken = token;
        console.log("Token acquired:", token);
        document.getElementById("tokenOutput").innerText = token;
      } catch (error) {
        console.error("Error getting token:", error);
        document.getElementById("tokenOutput").innerText = "Error: " + JSON.stringify(error, null, 2);
      }
    }

    document.getElementById("getTokenBtn").onclick = getToken;
  </script>
</body>
</html>
