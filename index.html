<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teams Personal App - Get Token</title>
  <script src="https://res.cdn.office.net/teams-js/2.18.0/js/MicrosoftTeams.min.js"></script>
</head>
<body style="font-family: Arial; text-align:center; padding:50px;">
  <h2>Teams Personal App  Token Test</h2>
  <p id="status">Initializing...</p>

  <script>
    // Step 1: Initialize Teams SDK
    microsoftTeams.app.initialize().then(() => {
      console.log("‚úÖ Teams SDK initialized");
      document.getElementById("status").innerText = "Getting token...";

      // Step 2: Request authentication token (SSO)
      microsoftTeams.authentication.getAuthToken({
        resources: ["api://akshay-babar-invimatic.github.io/f06fbb6a-9b84-4371-ae9b-9e18c37e8d40"],
        successCallback: (token) => {
          console.log("üîë Token acquired successfully!");
          console.log("Access Token:", token);
          document.getElementById("status").innerText = "Token printed in console.";
        },
        failureCallback: (error) => {
          console.error("‚ùå Failed to get token:", error);
          document.getElementById("status").innerText = "Failed to get token.";
        }
      });
    });
  </script>
</body>
</html>
