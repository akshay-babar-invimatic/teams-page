<!DOCTYPE html>
<html>
<head>
    <title>Website Tab</title>
    <style>
        body, html { 
            margin: 0; 
            padding: 0; 
            height: 100%; 
            width: 100%;
            font-family: Arial, sans-serif; 
            background-color: #f3f3f3;
        }
        #userIframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        #message {
            padding: 20px;
            color: #d9534f;
            font-size: 18px;
            text-align: center;
        }
    </style>
    <script src="https://statics.teams.microsoft.com/sdk/v1.13.1/js/MicrosoftTeams.min.js" crossorigin="anonymous"></script>
</head>
<body>
    <iframe id="userIframe" src="" style="display:none;"></iframe>
    <div id="message">Loading...</div>

    <script>
        console.log("Tab page script started");

        // Initialize Teams SDK
        microsoftTeams.initialize();
        console.log("Microsoft Teams SDK initialized");

        // Get the user URL from query string
        const params = new URLSearchParams(window.location.search);
        const userUrl = params.get('url');
        console.log("Query string parameters:", window.location.search);
        console.log("Extracted user URL:", userUrl);

        const iframe = document.getElementById('userIframe');
        const message = document.getElementById('message');

        if (userUrl) {
            console.log("Rendering iframe with user URL:", userUrl);
            iframe.src = userUrl;

            iframe.onload = () => {
                console.log("✅ Iframe successfully loaded:", userUrl);
            };

            iframe.onerror = (err) => {
                console.error("❌ Error loading iframe:", err);
                message.textContent = "Error loading the provided URL.";
            };

            iframe.style.display = "block";
            message.style.display = "none";
        } else {
            console.warn("No URL provided in query string");
            message.textContent = "⚠️ No URL provided. Please reconfigure the tab.";
        }

        console.log("Tab page script finished");
    </script>
</body>
</html>
